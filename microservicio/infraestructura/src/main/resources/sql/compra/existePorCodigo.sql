SELECT COUNT(1) FROM compra WHERE codigo = :codigo AND estado = :estado;